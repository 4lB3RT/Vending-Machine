#!/bin/sh

composer cs-fix >/dev/null 2>&1
if [ $? -ne 0 ]; then
  exit 1
fi

composer phpstan >/dev/null 2>&1
if [ $? -ne 0 ]; then
  exit 1
fi

composer test:unit >/dev/null 2>&1
if [ $? -ne 0 ]; then
  exit 1
fi

if [ -f "docker/commands/test-integration.sh" ]; then
  sh docker/commands/test-integration.sh >/dev/null 2>&1
  if [ $? -ne 0 ]; then
    exit 1
  fi
fi

if [ $? -eq 0 ]; then
  echo ""
  echo "  ╔══════════════════════════════════════════════╗"
  echo "  ║   VENDING MACHINE: Commit successful!       ║"
  echo "  ║   [🍫][🥤][🍪][🍬][🥨][🍩][🍭][🥛][🍟][🍔]   ║"
  echo "  ╚══════════════════════════════════════════════╝"
  echo ""
fi
